(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     27380,        656]
NotebookOptionsPosition[     25991,        602]
NotebookOutlinePosition[     26470,        622]
CellTagsIndexPosition[     26427,        619]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["image5.nb", "Section",
 CellChangeTimes->{{3.4988653974375*^9, 3.498865414203125*^9}, {
  3.50000220346875*^9, 3.50000220378125*^9}, {3.550913181566221*^9, 
  3.550913190536237*^9}}],

Cell[CellGroupData[{

Cell["\<\
Evolution of indirect reciprocity by image scoring
NATURE |VOL 393 | 11 JUNE 1998\
\>", "Subtitle",
 CellChangeTimes->{{3.496393047203125*^9, 3.49639305721875*^9}, {
  3.498016463421875*^9, 3.4980165105*^9}, {3.49886460865625*^9, 
  3.498864633765625*^9}, {3.550913116623307*^9, 3.5509131472461605`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Martin A. Nowak*\[Dagger] & Karl Sigmund\[DoubleDagger]
* Department of Zoology, University of Oxford, Oxford OX1 3 PS, UK
\[DoubleDagger] Institut fu\.a8r Mathematik, Universita\.a8t Wien, \
Strudlhofgasse 4, A - 1090 Wien,
Austria\
\>", "Subsubsection"],

Cell[TextData[{
 StyleBox["Assumptions\n1. Random pairs of players are chosen, of which one \
is the potential donor of some altruistic act and the other is the recipient. \
The donor can cooperate and help the recipient at a cost c to himself, in \
which case the recipient receives a benefit of value b (with b > c).If the \
donor decides not to help, both individuals receive zero pay - off.",
  FontSize->14],
 "\:ff08\:30da\:30a2\:304c\:30e9\:30f3\:30c0\:30e0\:306b\:9078\:3070\:308c\
\:ff0c\:30c9\:30ca\:30fc\:304b\:30ec\:30b7\:30d4\:30a8\:30f3\:30c8\:ff08\:53d7\
\:3051\:624b\:ff09\:306e\:5f79\:5272\:3092\:4e0e\:3048\:3089\:308c\:308b\:ff0e\
\:30c9\:30ca\:30fc\:306f\:30b3\:30b9\:30c8c\:3092\:6255\:3063\:3066\:30ec\
\:30b7\:30d4\:30a8\:30f3\:30c8\:306b\:5354\:529b\:3059\:308b\:3053\:3068\:304c\
\:3067\:304d\:ff0c\:305d\:306e\:5834\:5408\:30ec\:30b7\:30d4\:30a8\:30f3\:30c8\
\:306f\:5229\:5f97b\:3092\:3082\:3089\:3048\:308b\:ff0e\:3082\:3057\:30c9\
\:30ca\:30fc\:304c\:5354\:529b\:3057\:306a\:3044\:5834\:5408\:306f\:53cc\:65b9\
\:5229\:5f970\:3067\:3042\:308b\:ff09",
 StyleBox["\n   \n2. Each player has an image score, s, which is known to \
every other player. If a player is chosen as a donor and decides to \
cooperate, then his (or her) image score increases by one unit; if the donor \
does not cooperate then it decreases by one unit.The image score of a \
recipient does not change.",
  FontSize->14],
 "\:ff08\:5404\:30d7\:30ec\:30a4\:30e4\:30fc\:306f\:30a4\:30e1\:30fc\:30b8\
\:30b9\:30b3\:30a2s\:3092\:6301\:3061\:ff0c\:30c9\:30ca\:30fc\:306b\:306a\
\:3063\:305f\:969b\:ff0c\:5354\:529b\:3059\:308b\:3068+1\:ff0c\:975e\:5354\
\:529b\:3059\:308b\:3068-1\:5909\:5316\:3059\:308b\:ff0e\:30ec\:30b7\:30d4\
\:30a8\:30f3\:30c8\:306fs\:306e\:5024\:304c\:5909\:5316\:3057\:306a\:3044\
\:ff09",
 StyleBox["\n   \n3. We consider strategies where donors decide to help \
according to the image score of the recipient.A strategy is given by a number \
k : a player with this strategy provides help if, and only if, the image \
score of the potential recipient is at least k. The strategies are given by \
ki and the image levels by si. A donor, i, cooperates with a recipient, j, if \
ki <= sj. At the beginning of each generation, the image levels of all \
players are zero.",
  FontSize->14],
 "The image scores range from-5 to +5, the strategy (k) values from -5 to +6. \
The strategy k =-5 represents unconditional cooperators, whereas the strategy \
k=6 represents defectors.\:ff08\:30c9\:30ca\:30fc\:306f\:5354\:529b\:3059\
\:308b\:304b\:3069\:3046\:304b\:3092\:81ea\:5206\:306e\:6226\:7565k\:306e\
\:5024\:306b\:5fdc\:3058\:3066\:6c7a\:5b9a\:3059\:308b\:ff0e\:30c9\:30ca\:30fc\
\:306f\:81ea\:5206\:306e\:6226\:7565k\:3068\:30ec\:30b7\:30d4\:30a8\:30f3\
\:30c8\:306e\:30a4\:30e1\:30fc\:30b8\:30b9\:30b3\:30a2s\:3092\:6bd4\:8f03\
\:3057\:3066\:ff0ck<=s\:306e\:5834\:5408\:306b\:5354\:529b\:3059\:308b\:ff0e\
\:5404\:4e16\:4ee3\:306e\:6700\:521d\:306f\:30a4\:30e1\:30fc\:30b8\:30b9\:30b3\
\:30a2s\:306f\:5168\:30660\:3067\:3042\:308b\:ff0es\:306e\:30ec\:30f3\:30b8\
\:306f[-5,5], \
k\:306e\:30ec\:30f3\:30b8\:306f[-5,6]\:3067\:3042\:308b\:ff0ek=-5\:306f\:7121\
\:6761\:4ef6\:5354\:529b\:8005\:3067k=6\:306f\:5e38\:306b\:975e\:5354\:529b\
\:3092\:610f\:5473\:3059\:308b\:ff09",
 StyleBox["\n   \n4. In succession, m donor - recipient pairs are chosen. The \
fitness of a player is given by the total number of points received during \
the m interactions.Some players may never be chosen, in which case their \
payoff from the game will be zero. On average, a player will be chosen 2 m/n \
times, either as donor or as recipient.",
  FontSize->14],
 "\:ff08\:7e70\:308a\:8fd4\:3057\:306b\:304a\:3044\:3066\:ff0cm\:500b\:306e\
\:30c9\:30ca\:30fc\:30fb\:30ec\:30b7\:30d4\:30a8\:30f3\:30c8\:306e\:30da\:30a2\
\:304c\:9078\:629e\:3055\:308c\:308b\:ff0em\:56de\:306e\:76f8\:4e92\:884c\
\:70ba\:306e\:9593\:306b\:7372\:5f97\:3057\:305f\:7dcf\:5229\:5f97\:306b\:5fdc\
\:3058\:3066\:ff0c\:30d7\:30ec\:30a4\:30e4\:30fc\:306e\:9069\:5408\:5ea6\:304c\
\:6c7a\:307e\:308b\:ff0e\:ff09\n",
 StyleBox["   \n5. At the end of each generation, players leave offspring in \
proportion to their fitness.",
  FontSize->14],
 "\:ff08\:5404\:4e16\:4ee3\:306e\:7d42\:308f\:308a\:306b\:ff0c\:30d7\:30ec\
\:30a4\:30e4\:30fc\:306f\:9069\:5408\:5ea6\:306b\:5fdc\:3058\:3066\:5b50\:5b6b\
\:3092\:6b8b\:3059\:ff09"
}], "Text",
 CellChangeTimes->{
  3.500002236171875*^9, {3.500002269578125*^9, 3.50000229946875*^9}, {
   3.50000281359375*^9, 3.5000028444375*^9}, {3.50007984504525*^9, 
   3.500079846264*^9}, {3.500080592842125*^9, 3.500080612998375*^9}, {
   3.55091514497107*^9, 3.5509151550954876`*^9}, {3.550915317070572*^9, 
   3.550915338208609*^9}, 3.5509154674860363`*^9, 3.550915778550583*^9, {
   3.550916004423379*^9, 3.5509160106009903`*^9}, {3.55091640913589*^9, 
   3.5509164518951654`*^9}, {3.5509174276932783`*^9, 3.550917520700642*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:6982\:8981\:ff1a", "Section",
 CellChangeTimes->{3.550806584499326*^9}],

Cell[CellGroupData[{

Cell["\:30d7\:30ed\:30b0\:30e9\:30e0\:306e\:6d41\:308c", "Subsection",
 CellChangeTimes->{{3.4680178756875*^9, 3.468017953640625*^9}, {
   3.468018559328125*^9, 3.468018676125*^9}, {3.46801963684375*^9, 
   3.46801964909375*^9}, {3.500002364125*^9, 3.50000237921875*^9}, {
   3.50000255340625*^9, 3.50000260234375*^9}, {3.500002642171875*^9, 
   3.500002654796875*^9}, {3.5508066028917584`*^9, 3.550806612501375*^9}, {
   3.550913241875927*^9, 3.5509132556975517`*^9}, 3.5519969815145454`*^9}],

Cell[BoxData[{
 RowBox[{"0.", "\:521d\:671f\:5024\:8a2d\:5b9a", 
  RowBox[{
  "\:ff08", 
   "\:96c6\:56e3\:4eba\:6570n\:ff0c\:6226\:7565k\:ff0c\:30a4\:30e1\:30fc\:30b8\
\:30b9\:30b3\:30a2s\:7b49\:306e\:521d\:671f\:5024\:3092\:6c7a\:3081\:308b", 
   "\:ff09"}]}], "\[IndentingNewLine]", 
 RowBox[{"1.", "\:30de\:30c3\:30c1\:30f3\:30b0"}], "\[IndentingNewLine]", 
 RowBox[{"2.", "\:6226\:7565\:6c7a\:5b9a", 
  RowBox[{
  "\:ff08", 
   "\:5354\:529b\:3059\:308b\:304b\:5426\:304b\:3092\:6c7a\:5b9a\:3059\:308b",
    "\:ff09"}]}], "\[IndentingNewLine]", 
 RowBox[{"3.", 
  "\:6226\:7565\:306b\:5fdc\:3058\:3066\:5f97\:70b9\:3092\:4e0e\:3048\:308b"}]\
, "\[IndentingNewLine]", 
 RowBox[{"4.", "\:30a4\:30e1\:30fc\:30b8\:30b9\:30b3\:30a2", 
  RowBox[{"\:ff08", "\:8a55\:5224", "\:ff09"}], 
  "\:3092\:66f4\:65b0\:3059\:308b"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "5.", "\:5229\:5f97\:306b\:5fdc\:3058\:3066\:6226\:7565k\:3092\:5207\:308a\
\:66ff\:3048\:308b"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"6.", "\:7e70\:308a\:8fd4\:3057"}]}], "Input",
 CellChangeTimes->{{3.50008031767025*^9, 3.50008049604525*^9}, {
  3.50008053479525*^9, 3.500080569592125*^9}, {3.550806625511798*^9, 
  3.55080666081466*^9}, {3.550913267584772*^9, 3.550913295898822*^9}, {
  3.5519968877271805`*^9, 3.551996891455587*^9}, {3.551996959206506*^9, 
  3.5519969743073325`*^9}, {3.5519970071297903`*^9, 3.551997013853402*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5909\:6570\:540d\:4e00\:89a7", "Subsection",
 CellChangeTimes->{{3.4680178756875*^9, 3.468017953640625*^9}, {
   3.468018559328125*^9, 3.468018676125*^9}, {3.46801963684375*^9, 
   3.46801964909375*^9}, {3.500002364125*^9, 3.50000237921875*^9}, {
   3.50000255340625*^9, 3.500002571453125*^9}, {3.500002717015625*^9, 
   3.50000273271875*^9}, 3.5508066717190795`*^9, {3.550913310406848*^9, 
   3.5509133178480606`*^9}}],

Cell[BoxData[{
 RowBox[{"n", 
  RowBox[{"(*", "\:96c6\:56e3\:4eba\:6570", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"id", 
  RowBox[{
  "(*", "\:5404\:500b\:4f53\:306e\:756a\:53f7", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"klist", 
  RowBox[{
  "(*", "\:6226\:7565k\:306e\:30ea\:30b9\:30c8", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"slist", 
  RowBox[{
  "(*", "\:30a4\:30e1\:30fc\:30b8\:30b9\:30b3\:30a2\:306e\:30ea\:30b9\:30c8", 
   "\:3000", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"m", 
  RowBox[{
  "(*", "\:30de\:30c3\:30c1\:30f3\:30b0\:3059\:308b\:30da\:30a2\:306e\:6570", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"benefit", 
  RowBox[{
  "(*", "\:5229\:5f97\:306e\:30ea\:30b9\:30c8", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"generation", 
  RowBox[{
  "(*", "\:7e70\:308a\:8fd4\:3057\:56de\:6570", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"kdist", 
  RowBox[{
  "(*", " ", "\:6226\:7565k\:306e\:5206\:5e03", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.50008141692025*^9, 3.500081589748375*^9}, {
   3.5509133263968754`*^9, 3.5509134099038224`*^9}, {3.5509134625851145`*^9, 
   3.5509134656583204`*^9}, {3.5509135123180017`*^9, 3.55091359089534*^9}, 
   3.551997031044632*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Module\:306e\:5b9a\:7fa9", "Subsection",
 CellChangeTimes->{{3.550804782792961*^9, 3.5508047863965673`*^9}, {
  3.550913491101965*^9, 3.550913499385579*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "\:6226\:7565\:6bce\:306b\:9069\:5408\:5ea6\:3092\:6c7a\:3081\:305f\:5834\
\:5408\:ff0e", "\[IndentingNewLine]", "klist"}], "=", 
    RowBox[{
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"benefit", "\[Rule]", "klist"}], ",", "n"}], "]"}], " ", 
     "\:3092\:4f7f\:3063\:305f\:5834\:5408"}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"image12", "[", 
    RowBox[{"n_", 
     RowBox[{"(*", "\:4eba\:6570", "*)"}], ",", "m_", 
     RowBox[{"(*", "\:30da\:30a2\:306e\:6570", "*)"}], ",", "generations_"}], 
    RowBox[{"(*", "\:7e70\:308a\:8fd4\:3057\:6570", "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "id", ",", "klist", ",", "slist", ",", "benefit", ",", "pair", ",", 
       "kdist"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"id", "=", 
       RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"slist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"image", " ", "score", " ", "list"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"klist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Random", "[", 
          RowBox[{"Integer", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "6"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"strategy", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"benefit", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"benefit", " ", "list"}], ",", "  ", 
        "\:4ee5\:4e0a\:521d\:671f\:5316"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"slist", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
         RowBox[{"benefit", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", 
         RowBox[{
         "(*", " ", 
          "\:53cd\:5fa9\:3059\:308b\:969b\:ff0c\:30a4\:30e1\:30fc\:30b8\:3068\
\:5229\:5f97\:306f\:6bce\:56de\:521d\:671f\:5316\:3055\:308c\:308b", " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "\:300c", 
             "pair\:3092\:4e00\:500b\:3060\:3051\:4f5c\:308b\:64cd\:4f5c", 
             "\:300d"}], 
            "\:3092Do\:3067m\:56de\:53cd\:5fa9\:3055\:305b\:3066", 
            "\[IndentingNewLine]", 
            "m\:500b\:306e\:30da\:30a2\:3092\:4f5c\:308b\:ff0eslist\:306e\
\:60c5\:5831\:306f\:30eb\:30fc\:30d7\:306e\:5ea6\:306b\:66f4\:65b0\:3055\:308c\
\:308b"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pair", "=", 
             RowBox[{"RandomSample", "[", 
              RowBox[{"id", ",", "2"}], "]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<pair  \>\"", ",", "pair"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"klist", "\[LeftDoubleBracket]", 
                RowBox[{
                "pair", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "<=", 
               RowBox[{"slist", "\[LeftDoubleBracket]", 
                RowBox[{
                "pair", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"(*", " ", "\:5354\:529b\:6761\:4ef6", " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", "\:5354\:529b\:6642\:306e\:51e6\:7406", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"benefit", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "pair", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"benefit", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "pair", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "+", 
                 "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"benefit", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "pair", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"benefit", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "pair", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "-", 
                 "0.1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"slist", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "pair", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"slist", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "pair", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "+", 
                 "1"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
              "(*", "\:975e\:5354\:529b\:6642\:306e\:51e6\:7406", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"slist", "\[LeftDoubleBracket]", 
                RowBox[{
                "pair", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"slist", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "pair", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "-", 
                "1"}]}]}], "]"}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"if", " ", "\:7d42\:308f\:308a"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Min", "[", "benefit", "]"}], "<", "0"}], ",", 
              RowBox[{"benefit", "=", 
               RowBox[{"benefit", "+", "0.1"}]}], ",", 
              RowBox[{"benefit", "=", "benefit"}]}], "]"}]}], 
           RowBox[{
           "(*", "\:3000", 
            "benefit\:306e\:975e\:8ca0\:5316\:ff0c\:5229\:5f97\:306b\:5fdc\
\:3058\:3066klist\:3092\:66f4\:65b0\:3059\:308b\:305f\:3081", "\:3000", 
            "*)"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", "m", "}"}]}], "]"}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "1", "generation\:5185\:90e8\:3067\:306e\:30da\:30a2\:9078\:629e", 
           "\:3000", "Do\:7d42\:308f\:308a"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"kdist", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "12", "}"}]}], "]"}]}], ";", 
         RowBox[{
         "(*", " ", "\:6226\:7565k\:6bce\:306e\:5229\:5f97\:5206\:5e03", " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "klist", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[Equal]", 
                 RowBox[{"a", "-", "7"}]}], ",", 
                RowBox[{
                 RowBox[{
                 "kdist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{
                  RowBox[{
                  "kdist", "\[LeftDoubleBracket]", "a", 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{
                  "benefit", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                 "kdist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{
                 "kdist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "12"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{
          "(*", "\:6226\:7565\:6bce\:306b\:5229\:5f97\:5206\:5e03\:3092\:6c42\
\:3081\:308b", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "klist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", "kdist", "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{
               "klist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{"kdist", "\[Rule]", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{"-", "6"}], ",", "5"}], "]"}]}], "]"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
        RowBox[{
        "(*", " ", 
         "\:5229\:5f97\:306e\:9ad8\:3044\:9ad8\:3044\:6226\:7565\:306f\:5b50\
\:5b6b\:3092\:6b8b\:3057\:3084\:3059\:3044", " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"klist\:306e\:9014\:4e2d\:7d4c\:904e\:306e\:51fa\:529b", ";", 
          RowBox[{"kdist", "=", 
           RowBox[{"BinCounts", "[", 
            RowBox[{"klist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5"}], ",", "7", ",", "1"}], "}"}]}], "]"}]}], 
          ";", 
          RowBox[{"Print", "[", "klist", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "kdist", "]"}]}], "*)"}], ",", 
        RowBox[{"{", "generations", "}"}]}], "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{"Do", " ", "\:7d42\:308f\:308a"}], "*)"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kdist", "=", 
       RowBox[{"BinCounts", "[", 
        RowBox[{"klist", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "5"}], ",", "7", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "6"}], ",", "5"}], "]"}], ",", "kdist"}], "}"}], 
         "]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"n", "+", "1"}]}], "}"}]}], ",", 
        RowBox[{"Filling", "->", "Axis"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "Large", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.550917290990238*^9, 3.5509173180406857`*^9}, {
  3.5509176407116528`*^9, 3.5509176581368833`*^9}, {3.5509178108611517`*^9, 
  3.5509179116841288`*^9}, {3.5509179468309903`*^9, 3.5509179600754137`*^9}, {
  3.550918002928689*^9, 3.5509180660162*^9}, {3.550918169756382*^9, 
  3.5509183657083263`*^9}, {3.5509184587624893`*^9, 3.550918541598635*^9}, {
  3.550918649722425*^9, 3.550918668364458*^9}, {3.5519970959407463`*^9, 
  3.5519971285916033`*^9}, {3.5519971673264713`*^9, 3.5519972188221617`*^9}, {
  3.551997338411972*^9, 3.5519973598620095`*^9}, {3.5519975102774734`*^9, 
  3.5519975112290754`*^9}, {3.5519976052348404`*^9, 3.5519976176524625`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"image12", "[", 
  RowBox[{"50", 
   RowBox[{"(*", "\:4eba\:6570", "*)"}], ",", "125", 
   RowBox[{"(*", "\:30da\:30a2\:306e\:6570", "*)"}], ",", "100"}], 
  RowBox[{"(*", "\:7e70\:308a\:8fd4\:3057\:6570", "*)"}], "]"}]], "Input",
 CellChangeTimes->{{3.550918385723161*^9, 3.550918408140401*^9}, {
  3.550918560303068*^9, 3.550918572237089*^9}, {3.5519975568123555`*^9, 
  3.551997587201209*^9}}],

Cell[BoxData[
 GraphicsBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQESBxhQgAgaXwCNz4HGZ4DyPR0g9If9DHjBB3s0
AQc089H4Amh8ETQ+zH4YGLr+AQActhO1
   "], {{{}, {}, {}, {}, 
     {Hue[0.67, 0.6, 0.6], Opacity[0.2], LineBox[{13, 5}]}}, {{}, 
     {Hue[0.67, 0.6, 0.6], PointSize[Large], 
      PointBox[{14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25}]}, {}}}],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-6., 5.}, {-1, 51}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.550918394006776*^9, 3.550918416346015*^9}, {
   3.550918545108641*^9, 3.550918603062743*^9}, {3.551997056613077*^9, 
   3.5519970688278985`*^9}, 3.551997192707716*^9, 3.55199722345537*^9, {
   3.5519973478031883`*^9, 3.5519973939948697`*^9}, {3.551997524067898*^9, 
   3.5519976321292877`*^9}, {3.5519977664149237`*^9, 3.551997782170952*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:7df4\:7fd2\:554f\:984c", "Section",
 CellChangeTimes->{3.5519978574254837`*^9}],

Cell[CellGroupData[{

Cell["\:30da\:30a2\:306e\:6570\:304c\:5354\:529b\:8005\:5272\:5408\:306b\:53ca\
\:307c\:3059\:5f71\:97ff\:3092\:5206\:6790\:3057\:306a\:3055\:3044", \
"Subsection",
 CellChangeTimes->{{3.5519978799831233`*^9, 3.5519979367048225`*^9}, {
  3.55199838478441*^9, 3.5519984169828663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"image12", "[", 
  RowBox[{"50", 
   RowBox[{"(*", "\:4eba\:6570", "*)"}], ",", "200", 
   RowBox[{"(*", "\:30da\:30a2\:306e\:6570", "*)"}], ",", "50"}], 
  RowBox[{"(*", "\:7e70\:308a\:8fd4\:3057\:6570", "*)"}], "]"}]], "Input",
 CellChangeTimes->{{3.552000404420958*^9, 3.552000411784171*^9}}],

Cell[BoxData[
 GraphicsBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGCQAmIQDQESByC0kwOEFjnAgAIEoHwdqDwHmjwDGv/Dfga8
4IM9moADKpcDjS+AxhdB48PcD1d/ALu8E1Tf0PEfAJYAFWg=
   "], {{{}, {}, {}, {}, 
     {Hue[0.67, 0.6, 0.6], Opacity[0.2], LineBox[{13, 1}], 
      LineBox[{14, 3}]}}, {{}, 
     {Hue[0.67, 0.6, 0.6], PointSize[Large], 
      PointBox[{15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26}]}, {}}}],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-6., 5.}, {-1, 51}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.552000412657772*^9, 3.5520004383978176`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1637, 933},
WindowMargins->{{6, Automatic}, {Automatic, 1}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
Magnification->1.7999999523162842`,
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (2009\:5e744\:670823\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 188, 3, 127, "Section"],
Cell[CellGroupData[{
Cell[758, 27, 314, 6, 139, "Subtitle"],
Cell[CellGroupData[{
Cell[1097, 37, 265, 6, 127, "Subsubsection"],
Cell[1365, 45, 4937, 76, 882, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6339, 126, 79, 1, 127, "Section"],
Cell[CellGroupData[{
Cell[6443, 131, 493, 6, 65, "Subsection"],
Cell[6939, 139, 1428, 28, 276, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8404, 172, 427, 6, 65, "Subsection"],
Cell[8834, 180, 1246, 34, 308, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10117, 219, 163, 2, 65, "Subsection"],
Cell[10283, 223, 12742, 296, 1236, "Input"],
Cell[CellGroupData[{
Cell[23050, 523, 419, 8, 51, "Input"],
Cell[23472, 533, 960, 19, 447, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24493, 559, 87, 1, 127, "Section"],
Cell[CellGroupData[{
Cell[24605, 564, 284, 4, 65, "Subsection"],
Cell[CellGroupData[{
Cell[24914, 572, 318, 6, 51, "Input"],
Cell[25235, 580, 704, 16, 447, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
